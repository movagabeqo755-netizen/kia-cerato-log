<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>My Kia</title>
    <style>
        :root {
            --bg-color: #000000;
            --card-bg: #1C1C1E;
            --text-primary: #FFFFFF;
            --text-secondary: #8E8E93;
            --accent-color: #FF3B30; /* –ö—Ä–∞—Å–Ω—ã–π –∫–∞–∫ —É Kia –∏ Apple Error */
            --accent-blue: #0A84FF;
            --separator: #38383A;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden; /* –°–∫—Ä–æ–ª–ª–∏–º —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–Ω—Ç */
            display: flex;
            flex-direction: column;
        }

        /* --- LAYOUT --- */
        .screen {
            flex: 1;
            overflow-y: auto;
            padding: calc(var(--safe-top) + 20px) 16px calc(var(--safe-bottom) + 80px) 16px;
            display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            animation: fadeIn 0.3s ease;
        }

        .screen.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        h1 { font-size: 34px; font-weight: 700; margin: 0 0 20px 0; letter-spacing: 0.3px; }
        h2 { font-size: 20px; color: var(--text-secondary); margin: 0 0 10px 0; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;}

        /* --- FORMS --- */
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 24px;
        }

        .input-group {
            border-bottom: 1px solid var(--separator);
            padding: 16px;
            display: flex;
            flex-direction: column;
        }

        .input-group:last-child { border-bottom: none; }

        label {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        input, select, textarea {
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 17px;
            width: 100%;
            padding: 0;
            font-family: inherit;
        }
        
        input:focus, select:focus { outline: none; }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ–ª–µ–∫—Ç */
        select {
            appearance: none;
            background: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238E8E93' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E") no-repeat right center;
        }

        /* --- BUTTONS --- */
        .btn-main {
            background: var(--accent-color);
            color: white;
            width: 100%;
            padding: 16px;
            border-radius: 14px;
            border: none;
            font-size: 17px;
            font-weight: 600;
            margin-top: 10px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .btn-main:active { transform: scale(0.96); opacity: 0.8; }

        /* --- ARCHIVE LIST --- */
        .stat-card {
            background: linear-gradient(135deg, #1c1c1e 0%, #2c2c2e 100%);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid #333;
        }
        .stat-total { font-size: 32px; font-weight: 700; color: var(--text-primary); }
        .stat-label { font-size: 13px; color: var(--text-secondary); text-transform: uppercase; }

        .log-item {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            position: relative;
        }

        .log-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .log-date { color: var(--text-secondary); font-size: 14px; }
        .log-km { color: var(--text-primary); font-weight: 600; font-size: 15px; }
        
        .log-title { font-size: 17px; font-weight: 500; margin-bottom: 4px; }
        .log-details { font-size: 15px; color: var(--text-secondary); }
        .log-cost { color: var(--accent-color); font-weight: 600; margin-top: 4px; display: block;}

        .delete-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 59, 48, 0.15);
            color: #FF453A;
            border: none;
            border-radius: 8px;
            padding: 4px 10px;
            font-size: 12px;
            font-weight: 600;
        }

        /* --- TAB BAR (Bottom Navigation) --- */
        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: calc(50px + var(--safe-bottom));
            background: rgba(28, 28, 30, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-around;
            padding-bottom: var(--safe-bottom);
            z-index: 1000;
        }

        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .tab-btn.active { color: var(--accent-color); }
        
        .tab-icon { font-size: 24px; margin-top: 5px;}

    </style>
</head>
<body>

    <div id="screen-add" class="screen active">
        <h1>–ú–æ—è Kia Cerato</h1>
        
        <div class="card">
            <div class="input-group">
                <label>–ü—Ä–æ–±–µ–≥ (–∫–º)</label>
                <input type="tel" id="input-mileage" placeholder="185 000">
            </div>
            
            <div class="input-group">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞–±–æ—Ç</label>
                <select id="input-category">
                    <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                    <option value="–¢–û">–¢–û (–ú–∞—Å–ª–æ/–§–∏–ª—å—Ç—Ä–∞)</option>
                    <option value="–ü–æ–¥–≤–µ—Å–∫–∞">–ü–æ–¥–≤–µ—Å–∫–∞ (–†—ã—á–∞–≥–∏/–°—Ç–æ–π–∫–∏)</option>
                    <option value="–î–≤–∏–≥–∞—Ç–µ–ª—å">–î–≤–∏–≥–∞—Ç–µ–ª—å (–ì–†–ú/–†–µ–º–Ω–∏)</option>
                    <option value="–¢–æ—Ä–º–æ–∑–∞">–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</option>
                    <option value="–®–∏–Ω—ã">–®–∏–Ω—ã / –î–∏—Å–∫–∏</option>
                    <option value="–≠–ª–µ–∫—Ç—Ä–∏–∫–∞">–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ / –õ–∞–º–ø—ã</option>
                    <option value="–¢—é–Ω–∏–Ω–≥">–¢—é–Ω–∏–Ω–≥ / –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
                    <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                </select>
            </div>

            <div class="input-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ / –†–∞–±–æ—Ç—ã</label>
                <input type="text" id="input-title" placeholder="–ù–∞–ø—Ä: –°—Ç–æ–π–∫–∏ —Å—Ç–∞–±–∞ CTR">
            </div>

            <div class="input-group">
                <label>–¶–µ–Ω–∞ (‚ÇΩ)</label>
                <input type="tel" id="input-cost" placeholder="0">
            </div>

            <div class="input-group">
                <label>–ó–∞–º–µ—Ç–∫–∏ (–ê—Ä—Ç–∏–∫—É–ª, –ë—Ä–µ–Ω–¥)</label>
                <input type="text" id="input-notes" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...">
            </div>
        </div>

        <button class="btn-main" onclick="addRecord()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤</button>
    </div>

    <div id="screen-archive" class="screen">
        <h1>–ê—Ä—Ö–∏–≤</h1>
        
        <div class="stat-card">
            <div class="stat-label">–í—Å–µ–≥–æ –≤–ª–æ–∂–µ–Ω–æ</div>
            <div class="stat-total" id="total-spent">0 ‚ÇΩ</div>
        </div>

        <h2>–ò—Å—Ç–æ—Ä–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤</h2>
        <div id="archive-list">
            </div>
        
        <div style="text-align: center; color: #555; margin-top: 30px; font-size: 13px;">
            –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        </div>
    </div>

    <div class="tab-bar">
        <button class="tab-btn active" onclick="switchTab('add')">
            <span class="tab-icon">üîß</span>
            <span>–ì–∞—Ä–∞–∂</span>
        </button>
        <button class="tab-btn" onclick="switchTab('archive')">
            <span class="tab-icon">üìã</span>
            <span>–ê—Ä—Ö–∏–≤</span>
        </button>
    </div>

    <script>
        const STORAGE_KEY = 'kia_cerato_log_ios_v1';
        let repairs = [];

        // --- INIT ---
        window.onload = function() {
            loadData();
            // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–µ–≥–∞ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏
            if(repairs.length > 0) {
                document.getElementById('input-mileage').value = repairs[0].mileage;
            }
        };

        // --- NAVIGATION ---
        function switchTab(tabName) {
            // UI –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.screen').forEach(scr => scr.classList.remove('active'));

            if (tabName === 'add') {
                document.getElementById('screen-add').classList.add('active');
                document.querySelectorAll('.tab-btn')[0].classList.add('active');
            } else {
                document.getElementById('screen-archive').classList.add('active');
                document.querySelectorAll('.tab-btn')[1].classList.add('active');
                renderArchive();
            }
        }

        // --- DATA LOGIC ---
        function loadData() {
            const data = localStorage.getItem(STORAGE_KEY);
            if (data) {
                repairs = JSON.parse(data);
            }
        }

        function saveData() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(repairs));
        }

        function addRecord() {
            const mileage = document.getElementById('input-mileage').value;
            const category = document.getElementById('input-category').value;
            const title = document.getElementById('input-title').value;
            const cost = document.getElementById('input-cost').value;
            const notes = document.getElementById('input-notes').value;

            if (!mileage || category === "" || !title) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–±–µ–≥, –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ.');
                return;
            }

            const record = {
                id: Date.now(),
                date: new Date().toLocaleDateString('ru-RU'),
                timestamp: Date.now(),
                mileage: mileage,
                category: category,
                title: title,
                cost: cost ? parseInt(cost.replace(/\D/g,'')) : 0, // –£–±–∏—Ä–∞–µ–º –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã
                notes: notes
            };

            repairs.unshift(record); // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞
            saveData();
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('input-title').value = '';
            document.getElementById('input-cost').value = '';
            document.getElementById('input-notes').value = '';
            document.getElementById('input-category').selectedIndex = 0;

            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
            if(navigator.vibrate) navigator.vibrate(50);
            
            alert('–ó–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –ê—Ä—Ö–∏–≤!');
            switchTab('archive');
        }

        function deleteRecord(id) {
            if(confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ?')) {
                repairs = repairs.filter(r => r.id !== id);
                saveData();
                renderArchive();
            }
        }

        // --- RENDER ---
        function renderArchive() {
            const list = document.getElementById('archive-list');
            const totalEl = document.getElementById('total-spent');
            list.innerHTML = '';
            
            let totalSum = 0;

            if (repairs.length === 0) {
                list.innerHTML = '<div style="text-align:center; padding: 20px; color: #555;">–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</div>';
                totalEl.innerText = '0 ‚ÇΩ';
                return;
            }

            repairs.forEach(item => {
                totalSum += item.cost;
                
                const div = document.createElement('div');
                div.className = 'log-item';
                
                const formattedCost = new Intl.NumberFormat('ru-RU').format(item.cost);

                div.innerHTML = `
                    <div class="log-header">
                        <span class="log-date">${item.date}</span>
                        <span class="log-km">${item.mileage} –∫–º</span>
                    </div>
                    <div class="log-title">${item.title}</div>
                    <div class="log-details">${item.category} ${item.notes ? '‚Ä¢ ' + item.notes : ''}</div>
                    <div class="log-cost">${formattedCost} ‚ÇΩ</div>
                    <button class="delete-btn" onclick="deleteRecord(${item.id})">–£–¥–∞–ª–∏—Ç—å</button>
                `;
                list.appendChild(div);
            });

            totalEl.innerText = new Intl.NumberFormat('ru-RU').format(totalSum) + ' ‚ÇΩ';
        }
    </script>
</body>
</html>