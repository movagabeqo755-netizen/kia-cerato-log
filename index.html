<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Kia Cerato 1 Log</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #000000);
            --text-color: var(--tg-theme-text-color, #ffffff);
            --hint-color: var(--tg-theme-hint-color, #8e8e93);
            --link-color: var(--tg-theme-link-color, #0a84ff);
            --button-color: var(--tg-theme-button-color, #0a84ff);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #1c1c1e);
            --kia-red: #ff3b30; /* –¶–≤–µ—Ç –∫–∞–∫ –≤ iOS –æ—à–∏–±–∫–∞—Ö */
            --delete-color: #ff453a;
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            /* –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã Apple */
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden; /* –ó–∞–ø—Ä–µ—Ç —Å–∫—Ä–æ–ª–ª–∞ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
            /* –ó–∞–ø—Ä–µ—Ç –ø—Ä—É–∂–∏–Ω—è—â–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–∞ iOS */
            overscroll-behavior: none;
        }

        body {
            display: flex;
            flex-direction: column;
            /* –£—á–µ—Ç –≤–µ—Ä—Ö–Ω–µ–≥–æ –æ—Ç—Å—Ç—É–ø–∞ (—á–µ–ª–∫–∏) */
            padding-top: env(safe-area-inset-top);
        }

        .content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 20px;
            /* –ë–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –∑–∞–µ–∑–∂–∞–ª –∑–∞ —Ç–∞–±–±–∞—Ä –∏ safe area */
            padding-bottom: calc(90px + env(safe-area-inset-bottom));
            /* –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –Ω–æ –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ body */
            overscroll-behavior-y: contain;
            -webkit-overflow-scrolling: touch; /* –ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª –Ω–∞ iOS */
        }

        h1 { margin: 0 0 8px 0; font-size: 28px; font-weight: 700; letter-spacing: 0.3px; }
        .subtitle { color: var(--hint-color); font-size: 15px; margin-bottom: 24px; }

        /* –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö - —Å—Ç–∏–ª—å iOS –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .input-card {
            background-color: var(--secondary-bg);
            border-radius: 12px;
            padding: 0 16px;
            margin-bottom: 20px;
        }

        .input-row {
            border-bottom: 0.5px solid rgba(128, 128, 128, 0.2); /* –¢–æ–Ω–∫–∏–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å */
            padding: 12px 0;
            display: flex;
            flex-direction: column;
        }
        .input-row:last-child { border-bottom: none; }

        label { display: block; font-size: 13px; color: var(--hint-color); margin-bottom: 6px; }
        /* –†–∞–∑–º–µ—Ä 17px –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑—É–º –ø—Ä–∏ –≤–≤–æ–¥–µ –Ω–∞ iPhone */
        input, select { width: 100%; background: transparent; border: none; color: var(--text-color); font-size: 17px; outline: none; padding: 0; font-family: inherit;}
        select { -webkit-appearance: none; } /* –£–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–µ–ª–∫—É iOS */

        /* –ò—Å—Ç–æ—Ä–∏—è –∏ –°–≤–∞–π–ø (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è) */
        .log-item-wrapper {
            position: relative;
            margin-bottom: 12px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--delete-color); /* –ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω –ü–û–î –∫–∞—Ä—Ç–æ—á–∫–æ–π */
        }

        .log-item {
            background-color: var(--secondary-bg);
            padding: 16px;
            position: relative;
            z-index: 10; /* –ö–∞—Ä—Ç–æ—á–∫–∞ –í–´–®–ï –∫—Ä–∞—Å–Ω–æ–≥–æ —Ñ–æ–Ω–∞ */
            transition: transform 0.25s cubic-bezier(0.2, 0.8, 0.2, 1); /* –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è iOS */
            border-radius: 12px;
        }

        .log-item.swiped {
            transform: translateX(-90px); /* –°–¥–≤–∏–≥ –≤–ª–µ–≤–æ */
        }

        /* –¢–µ–∫—Å—Ç "–£–¥–∞–ª–∏—Ç—å" –ª–µ–∂–∏—Ç –ü–û–î –∫–∞—Ä—Ç–æ—á–∫–æ–π */
        .swipe-delete-text {
            position: absolute;
            top: 0;
            right: 0;
            width: 90px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 15px;
            z-index: 1;
        }

        .log-top { display: flex; justify-content: space-between; margin-bottom: 6px; align-items: baseline;}
        .log-date { font-size: 13px; color: var(--hint-color); }
        .log-part { font-weight: 600; font-size: 17px; margin-bottom: 4px; line-height: 1.3; }
        .log-details { font-size: 14px; color: var(--hint-color); }
        .log-cost { color: var(--kia-red); font-weight: 600; margin-top: 8px; display: block; font-size: 16px;}

        /* –≠–∫—Ä–∞–Ω "–û –ø—Ä–æ–≥—Ä–∞–º–º–µ" */
        .about-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 60%;
            text-align: center;
        }
        .about-card-info {
             background-color: var(--secondary-bg);
             padding: 30px;
             border-radius: 20px;
             width: 80%;
             max-width: 300px;
        }
        .ver-text { font-size: 18px; font-weight: bold; margin-bottom: 10px; }
        .creator-text { font-size: 15px; color: var(--hint-color); }
        .creator-name { color: var(--text-color); font-weight: 600; }


        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é —Å —É—á–µ—Ç–æ–º Safe Area */
        .tab-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background-color: rgba(28, 28, 30, 0.95); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –∫–∞–∫ –≤ iOS */
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            display: flex; justify-content: space-around;
            padding-top: 10px;
            /* –í–∞–∂–Ω–æ: –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è iPhone –±–µ–∑ –∫–Ω–æ–ø–∫–∏ Home */
            padding-bottom: calc(5px + env(safe-area-inset-bottom));
            border-top: 0.5px solid rgba(128, 128, 128, 0.2);
            z-index: 100;
        }
        .tab-btn { background: none; border: none; color: var(--hint-color); font-size: 10px; display: flex; flex-direction: column; align-items: center; flex: 1; }
        .tab-btn.active { color: var(--button-color); }
        .tab-icon { font-size: 22px; margin-bottom: 4px; }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤ */
        .screen { display: none; opacity: 0; transition: opacity 0.2s ease-in-out;}
        .screen.active { display: block; opacity: 1; }
    </style>
</head>
<body>

    <div id="screen-garage" class="screen active content">
        <h1 id="main-title">Kia Cerato 1</h1>
        <div class="subtitle" id="garage-subtitle">–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</div>

        <div class="input-card">
            <div class="input-row">
                <label>–ü—Ä–æ–±–µ–≥ (–∫–º)</label>
                <input type="number" id="inp-mileage" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 295000">
            </div>
            <div class="input-row">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select id="inp-category">
                    <option value="–¢–û">–¢–û (–ú–∞—Å–ª–æ/–§–∏–ª—å—Ç—Ä—ã)</option>
                    <option value="–ü–æ–¥–≤–µ—Å–∫–∞">–ü–æ–¥–≤–µ—Å–∫–∞</option>
                    <option value="–î–≤–∏–≥–∞—Ç–µ–ª—å">–î–≤–∏–≥–∞—Ç–µ–ª—å / –ì–†–ú</option>
                    <option value="–¢–æ—Ä–º–æ–∑–∞">–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</option>
                    <option value="–≠–ª–µ–∫—Ç—Ä–∏–∫–∞">–≠–ª–µ–∫—Ç—Ä–∏–∫–∞</option>
                    <option value="–ö—É–∑–æ–≤">–ö—É–∑–æ–≤ / –°–∞–ª–æ–Ω</option>
                    <option value="–®–∏–Ω—ã">–®–∏–Ω—ã / –î–∏—Å–∫–∏</option>
                    <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                </select>
            </div>
            <div class="input-row">
                <label>–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ</label>
                <input type="text" id="inp-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç">
            </div>
            <div class="input-row">
                <label>–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)</label>
                <input type="number" id="inp-cost" placeholder="0">
            </div>
            <div class="input-row">
                <label>–ó–∞–º–µ—Ç–∫–∏</label>
                <input type="text" id="inp-notes" placeholder="–ë—Ä–µ–Ω–¥, –∞—Ä—Ç–∏–∫—É–ª...">
            </div>
        </div>
    </div>

    <div id="screen-archive" class="screen content">
        <h1>–ò—Å—Ç–æ—Ä–∏—è</h1>
        <div class="subtitle" id="total-spent">–í—Å–µ–≥–æ: 0 ‚ÇΩ</div>
        <div id="logs-container"></div>
    </div>

    <div id="screen-about" class="screen content">
        <h1>–û –ø—Ä–æ–≥—Ä–∞–º–º–µ</h1>
        <div class="about-container">
            <div class="about-card-info">
                <div class="ver-text">–í–µ—Ä—Å–∏—è 4.0 (iOS)</div>
                <div class="creator-text">–°–æ–∑–¥–∞—Ç–µ–ª—å: <span class="creator-name">romerioyalta</span></div>
            </div>
        </div>
    </div>

    <div class="tab-bar">
        <button class="tab-btn active" onclick="switchTab('garage')">
            <span class="tab-icon">üõ†</span>
            <span>–ì–∞—Ä–∞–∂</span>
        </button>
        <button class="tab-btn" onclick="switchTab('archive')">
            <span class="tab-icon">üìã</span>
            <span>–ê—Ä—Ö–∏–≤</span>
        </button>
        <button class="tab-btn" onclick="switchTab('about')">
            <span class="tab-icon">‚ÑπÔ∏è</span>
            <span>–ò–Ω—Ñ–æ</span>
        </button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç —Ö–µ–¥–µ—Ä–∞ –ø–æ–¥ —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –¥–ª—è –±–µ—Å—à–æ–≤–Ω–æ—Å—Ç–∏
        tg.setHeaderColor(tg.themeParams.bg_color);
        tg.setBackgroundColor(tg.themeParams.bg_color);

        tg.MainButton.text = "–î–û–ë–ê–í–ò–¢–¨ –ó–ê–ü–ò–°–¨";
        tg.MainButton.show();
        
        const STORAGE_KEY = 'kia_tg_log_v2';
        let logs = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        let editingId = null;

        // –ê–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–±–µ–≥–∞
        if (logs.length > 0) {
             document.getElementById('inp-mileage').value = logs[0].mileage;
        }

        // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ---
        tg.MainButton.onClick(() => {
            // –ï—Å–ª–∏ –º—ã –≤ –∞—Ä—Ö–∏–≤–µ –∏–ª–∏ –≤ "–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ", –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–∏–¥—ã–≤–∞–µ—Ç –≤ –≥–∞—Ä–∞–∂
            if (!document.getElementById('screen-garage').classList.contains('active')) {
                switchTab('garage');
                return;
            }
            saveRecord();
        });

        function switchTab(tab) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ –∏ –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            
            tg.HapticFeedback.selectionChanged(); // –õ–µ–≥–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏

            if (tab === 'garage') {
                document.getElementById('screen-garage').classList.add('active');
                document.querySelectorAll('.tab-btn')[0].classList.add('active');
                updateMainButtonState();
                tg.MainButton.show();
            } else if (tab === 'archive') {
                exitEditMode();
                document.getElementById('screen-archive').classList.add('active');
                document.querySelectorAll('.tab-btn')[1].classList.add('active');
                tg.MainButton.hide(); // –í –∞—Ä—Ö–∏–≤–µ –∫–Ω–æ–ø–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
                renderLogs();
            } else if (tab === 'about') {
                exitEditMode();
                document.getElementById('screen-about').classList.add('active');
                document.querySelectorAll('.tab-btn')[2].classList.add('active');
                tg.MainButton.hide(); // –í "–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ" –∫–Ω–æ–ø–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞
            }
        }

        // --- –õ–û–ì–ò–ö–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø ---
        function saveRecord() {
            const mileage = document.getElementById('inp-mileage').value;
            const title = document.getElementById('inp-title').value;
            const costStr = document.getElementById('inp-cost').value;
            
            if (!mileage || !title) {
                tg.showPopup({title: '–û—à–∏–±–∫–∞', message: '–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–±–µ–≥ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç'});
                tg.HapticFeedback.notificationOccurred('error');
                return;
            }

            const recordData = {
                id: editingId || Date.now(),
                date: editingId ? getLogById(editingId).date : new Date().toLocaleDateString('ru-RU'),
                mileage: mileage,
                category: document.getElementById('inp-category').value,
                title: title,
                cost: costStr ? parseInt(costStr.replace(/\D/g,'')) : 0,
                notes: document.getElementById('inp-notes').value
            };

            if (editingId) {
                logs = logs.map(l => l.id === editingId ? recordData : l);
            } else {
                logs.unshift(recordData);
            }

            localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
            clearForm();
            exitEditMode();
            tg.HapticFeedback.notificationOccurred('success');
            tg.showPopup({message: editingId ? '–ó–∞–ø–∏—Å—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞!' : '–ó–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª–µ–Ω–∞!'});
        }

        // --- –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï ---
        window.startEdit = function(id) {
            const log = getLogById(id);
            if (!log) return;
            editingId = id;
            document.getElementById('inp-mileage').value = log.mileage;
            document.getElementById('inp-category').value = log.category;
            document.getElementById('inp-title').value = log.title;
            document.getElementById('inp-cost').value = log.cost;
            document.getElementById('inp-notes').value = log.notes;
            document.getElementById('garage-subtitle').innerText = `–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏`;
            switchTab('garage');
        }

        function exitEditMode() {
            editingId = null;
            document.getElementById('garage-subtitle').innerText = "–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å";
            updateMainButtonState();
            if(!document.getElementById('inp-mileage').value && logs.length > 0) {
                 document.getElementById('inp-mileage').value = logs[0].mileage;
            }
        }
        
        function updateMainButtonState() {
             if (editingId) {
                tg.MainButton.text = "–°–û–•–†–ê–ù–ò–¢–¨ –ò–ó–ú–ï–ù–ï–ù–ò–Ø";
                tg.MainButton.color = "#34c759"; // –ó–µ–ª–µ–Ω—ã–π
            } else {
                tg.MainButton.text = "–î–û–ë–ê–í–ò–¢–¨ –ó–ê–ü–ò–°–¨";
                tg.MainButton.color = tg.themeParams.button_color; // –°–∏–Ω–∏–π
            }
        }

        function clearForm() {
            document.getElementById('inp-title').value = '';
            document.getElementById('inp-cost').value = '';
            document.getElementById('inp-notes').value = '';
        }
        
        function getLogById(id) { return logs.find(l => l.id === id); }

        // --- –†–ï–ù–î–ï–†–ò–ù–ì –ò–°–¢–û–†–ò–ò –ò –°–í–ê–ô–ü–´ ---
        function renderLogs() {
            const container = document.getElementById('logs-container');
            container.innerHTML = '';
            let total = 0;

            if (logs.length === 0) {
                container.innerHTML = '<p style="text-align:center;color:var(--hint-color);margin-top:50px;font-size:15px;">–ò—Å—Ç–æ—Ä–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤ –ø—É—Å—Ç–∞</p>';
                document.getElementById('total-spent').innerText = '–í—Å–µ–≥–æ: 0 ‚ÇΩ';
                return;
            }

            logs.forEach(log => {
                total += log.cost;
                const wrapper = document.createElement('div');
                wrapper.className = 'log-item-wrapper';
                
                // –¢–µ–∫—Å—Ç "–£–¥–∞–ª–∏—Ç—å" –ª–µ–∂–∏—Ç –ü–û–î –∫–∞—Ä—Ç–æ—á–∫–æ–π (z-index: 1)
                wrapper.innerHTML = `<div class="swipe-delete-text" onclick="deleteLogConfirm(${log.id})">–£–¥–∞–ª–∏—Ç—å</div>`;

                const el = document.createElement('div');
                el.className = 'log-item';
                el.onclick = () => startEdit(log.id);
                
                el.innerHTML = `
                    <div class="log-top">
                        <span class="log-date">${log.date}</span>
                        <span style="font-weight:600; font-size:15px;">${log.mileage} –∫–º</span>
                    </div>
                    <div class="log-part">${log.title}</div>
                    <div class="log-details">${log.category} ${log.notes ? '‚Ä¢ '+log.notes : ''}</div>
                    <span class="log-cost">${new Intl.NumberFormat('ru-RU').format(log.cost)} ‚ÇΩ</span>
                `;
                
                enableSwipe(el);
                wrapper.appendChild(el);
                container.appendChild(wrapper);
            });
            document.getElementById('total-spent').innerText = `–í—Å–µ–≥–æ: ${new Intl.NumberFormat('ru-RU').format(total)} ‚ÇΩ`;
        }

        // –õ–æ–≥–∏–∫–∞ —Å–≤–∞–π–ø–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞)
        function enableSwipe(element) {
            let startX = 0;
            let isSwiping = false;

            element.addEventListener('touchstart', e => {
                startX = e.changedTouches[0].screenX;
                isSwiping = true;
            }, {passive: true});
            
            element.addEventListener('touchmove', e => {
                 if(!isSwiping) return;
                 const currentX = e.changedTouches[0].screenX;
                 // –ï—Å–ª–∏ –Ω–∞—á–∞–ª–∏ —Ç—è–Ω—É—Ç—å –≤–ª–µ–≤–æ, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª
                 if (startX - currentX > 10) {
                     e.preventDefault(); 
                 }
            }, {passive: false}); // passive: false –≤–∞–∂–Ω–æ –¥–ª—è e.preventDefault()

            element.addEventListener('touchend', e => {
                isSwiping = false;
                const endX = e.changedTouches[0].screenX;
                const threshold = 60; // –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–≤–∞–π–ø–∞

                if (endX + threshold < startX) {
                    // –°–≤–∞–π–ø –≤–ª–µ–≤–æ -> –û—Ç–∫—Ä—ã—Ç—å
                    document.querySelectorAll('.log-item.swiped').forEach(i => i.classList.remove('swiped'));
                    element.classList.add('swiped');
                    tg.HapticFeedback.impactOccurred('light');
                } else if (endX > startX + threshold) {
                    // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ -> –ó–∞–∫—Ä—ã—Ç—å
                    element.classList.remove('swiped');
                }
            }, {passive: true});
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–≤–∞–π–ø–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤ –¥—Ä—É–≥–æ–µ –º–µ—Å—Ç–æ
        document.addEventListener('click', e => {
            if (!e.target.closest('.log-item-wrapper')) {
                 document.querySelectorAll('.log-item.swiped').forEach(i => i.classList.remove('swiped'));
            }
        });

        function deleteLogConfirm(id) {
             // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ –¢–µ–ª–µ–≥—Ä–∞–º
             tg.showConfirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å –Ω–∞–≤—Å–µ–≥–¥–∞?", function(ok) {
                if (ok) {
                    logs = logs.filter(l => l.id !== id);
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
                    renderLogs();
                    tg.HapticFeedback.notificationOccurred('success');
                } else {
                    // –ï—Å–ª–∏ –æ—Ç–º–µ–Ω–∏–ª–∏, –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å–≤–∞–π–ø
                    renderLogs();
                }
            });
        }
    </script>
</body>
</html>
